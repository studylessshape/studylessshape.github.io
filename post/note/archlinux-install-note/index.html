<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.147.7"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><meta name=description content="记录下安装 Archlinux 的经历"><title>Archlinux 安装笔记&nbsp;&ndash;&nbsp;学少何Blog</title><link rel=stylesheet href=/css/core.min.32478a57f52c16ea8d985cfbd2d28edda6d39bfc82a9b118b94caa532c16ce3f1e869e1d49ccce4a74134efed6bdafa0.css integrity=sha384-MkeKV/UsFuqNmFz70tKO3abTm/yCqbEYuUyqUywWzj8ehp4dSczOSnQTTv7Wva+g><meta name=twitter:card content="summary"><meta name=twitter:title content="Archlinux 安装笔记"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">学少何Blog</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories>归类</a><a class="nav item" href=/tags>标签</a><a class="nav item" href=/about>关于</a><a class="nav item" href=/index%2exml>RSS</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Archlinux 安装笔记</h1><p class="article date">2024年6月6日 6:06<span class=lastmod> • 更新于 2024年6月7日 6:07</span></p></section><article class="article markdown-body"><h2 id=前言>前言</h2><p>在 618 期间买了台新电脑，因为很早之前就想试试直接在电脑上而不是虚拟机里使用 Linux 系统，所以尝试着给旧电脑安装 Archlinux，原因有两点：</p><ol><li>Archlinux 自由度高</li><li>因为有 <code>archinstall</code>，目前的安装 Archlinux 已经非常简单了。</li></ol><blockquote><p>另外这台旧电脑准备送给家人用，Linux 不太方便的安装软件方式，可以杜绝调很多安全问题。</p></blockquote><p>旧电脑为华硕（ASUS）的飞行堡垒5。</p><ul><li>CPU: Intel(R) Core(TM) i5-8300H CPU @ 2.30GHz</li><li>显卡: NVIDIA GeForce GTX 1050Ti</li><li>内存: 16GB Samsung 2667MHz （内存曾经自己加了一个 8GB 的）</li><li>主板: ASUSTek COMPUTER INC. FX505GE</li></ul><h2 id=用到的网站>用到的网站</h2><ul><li><a href=https://archlinux.org/ target=_blank rel="noopener noreferrer">Archlinux 官网</a><blockquote><p>下载 Archlinux 镜像</p></blockquote></li><li><a href=https://rufus.ie/zh/ target=_blank rel="noopener noreferrer">rufus</a><blockquote><p>镜像安装引导盘制作</p></blockquote></li><li><a href=https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97 target=_blank rel="noopener noreferrer">官方安装教程（中文翻译）</a></li><li><a href=https://arch.icekylin.online/guide/ target=_blank rel="noopener noreferrer">Archlinux 简明指南</a><blockquote><p>包含安装教程，和一些常用软件、工具的安装</p></blockquote></li><li><a href=http://rsproxy.cn/ target=_blank rel="noopener noreferrer">RsProxy</a><blockquote><p>目前使用过最快的国内 Rust 镜像</p></blockquote></li><li><a href=https://github.com/Morganamilo/paru target=_blank rel="noopener noreferrer">paru</a><blockquote><p>AUR 软件包安装助手</p></blockquote></li><li><a href=https://aur.archlinux.org/ target=_blank rel="noopener noreferrer">AUR</a><blockquote><p>archlinux 的 aur 仓库网页，搜索需要的软件包很方便，官方直接支持的软件包可以点开 <code>Home</code> 旁边的 <code>packages</code> 查看</p></blockquote></li></ul><h2 id=下载镜像>下载镜像</h2><p>进入 <a href=https://archlinux.org/ target=_blank rel="noopener noreferrer">Archlinux 官网</a>，点击导航栏最右侧的 Download，然后下载 torrent 文件，使用自己常用的种子下载工具下载镜像即可。</p><blockquote><p>直接使用磁力链接也可以，但是部分时候磁力链接可能加载不了下载列表。</p></blockquote><p><img loading=lazy src=01.arhclinux-download.png alt=archlinux-download></p><p>Archlinux 的镜像文件相对来说比较小。写这篇博客时，下载的版本是 <code>archlinux-2024.06.01-x86_64</code>。</p><h3 id=启动盘制作>启动盘制作</h3><p>此处我使用 <a href=https://rufus.ie/zh/ target=_blank rel="noopener noreferrer">rufus</a>，当然其他制作工具也是可以的。</p><p><strong>！！！制作启动盘前，请将 U 盘内的重要数据进行备份！！！</strong></p><p>插入一个 U 盘，然后打开 rufus，分区类型选择 GPT，目标系统类型选择 UEFI，然后点击开始。</p><p><img loading=lazy src=02.arhclinux-ustart-make.png alt=rufus-make></p><p>U 盘会先被格式化，然后 rufus 会写入系统镜像。</p><h2 id=bios-设置>BIOS 设置</h2><p>在 BIOS 设置里关闭安全启动，不同的主板可能 BIOS 界面有所区别。</p><h2 id=启动安装引导>启动安装引导</h2><p>此处需要根据不同的主板来进行操作，比如华硕的主板，出现 ASUS Logo 时长按 ESC 键，然后选择 USB 启动即可。</p><p>因为电脑已经寄走了，所以之后的安装画面都会使用虚拟机。</p><p>安装选择版本选择 <code>x86_64</code> 即可，也可根据自己电脑的实际情况选择。</p><p><img loading=lazy src=03.arhclinux-bios.png alt=archlinux-bios></p><p><img loading=lazy src=04.arhclinux-bios-enter.png alt=archlinux-bios-enter></p><p>出现上图的样子，就是成功进入了安装界面了。</p><h2 id=检查网络>检查网络</h2><p>在进入安装界面的上面，有这样一段话：</p><p><img loading=lazy src=05.network-hint.png alt=network-hint></p><p>输入 <code>iwctl</code> 可以进入无线网络的连接程序。输入 <code>help</code> 指令可以获取帮助。</p><p>Wlan 联网可以参考简明指南的<a href=https://arch.icekylin.online/guide/rookie/basic-install.html#_3-%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C target=_blank rel="noopener noreferrer">连接网络章节</a>。</p><p>因为有线网能直接检测到，所以我选择的方法是直连随身 WIFI 或者通过手机的 USB 来共享网络。</p><h2 id=检查磁盘>检查磁盘</h2><p>这一步的目的是为了清空磁盘。如果需要重装 Archlinux，这一步比较关键。</p><blockquote><p>在重装 Archlinux 时，如果不预先删掉分区，<code>archinstall</code> 的磁盘选项里，通过建议创建的分区后，不会删掉原来的分区，安装报错并中断。</p></blockquote><p>！！！清空磁盘前，请确认磁盘的重要数据已经备份！！！</p><p>输入 <code>fdisk -l</code>，查看自己的磁盘。</p><p><img loading=lazy src=06.fdisk-list.png alt=fdisk-list></p><p>上面显示的有两个磁盘，其中 <code>/dev/sda</code> 是我现在的磁盘。</p><p>如果有分区，即上面的命令有 <code>/dev/sda1</code>、<code>/dev/sda2</code>，建议输入 <code>fdisk /dev/sda</code>，进入磁盘管理控制台。然后输入 <code>d</code> + 回车删除分区，多个分区需要多次 <code>d</code> 指令。</p><blockquote><p>电脑如果有两个磁盘，或者只有一个磁盘但是已经安装了 Windows 系统，可能会导致 <code>archinstall</code> 无法找到该磁盘，但是 <code>fdisk</code> 能够列出该磁盘，所以可能需要同样的方式删除磁盘分区（待验证）。</p></blockquote><h2 id=安装>安装</h2><p>网络和磁盘配置好之后，可以键入 <code>archinstall</code> + 回车，来安装 Archlinux 了。</p><p><img loading=lazy src=07.enter-archinstall.png alt=enter-archinstsall></p><blockquote><p>如果一直卡在 <code>Check version</code>，可以使用 <code>Ctrl</code> + <code>C</code> 先终止安装，再输入 <code>archinstall --skip-version-check</code> 来禁止版本检查。</p></blockquote><p>进入 <code>archinstall</code> 的页面如上所示。</p><p><code>Archinstall language</code> 不作修改，点击 <code>↓</code> 或 <code>j</code> 选择 <code>Mirrors</code>，回车进入后选择 <code>Mirror region</code> 并回车。等待一小会儿之后，键入 <code>/china</code>，搜索国内镜像，并回车选择。</p><p><img loading=lazy src=08.mirrors-select.gif alt=mirrors-select></p><p>按 <code>j</code> 到 <code>← Back</code> 并回车。进入 <code>Locales</code> 设置，需要更改的是 <code>Locale language</code>，进入后，选择 <code>zh-cn.UTF8</code>。</p><p><img loading=lazy src=09.locale-select.gif alt=locale-select></p><p>然后是磁盘配置。直接使用建议配置就行，因为之前已经做了删除分区的操作，所以执行安装时应该不会出错了。磁盘格式可以按自己需要选择，此处选择 <code>btrfs</code>。</p><p><img loading=lazy src=10.disk-configuration.gif alt=disk-configuration></p><p>主机名可以按需求更改，此处不变。</p><p><code>Root Password</code> 即 root 用户密码，建议设置一个。<code>User account</code> 里，设置一个用户，是否有 <code>sudo</code> 权限可以根据自己需要来，为了方便我设置了 <code>sudo</code> 权限。</p><p><img loading=lazy src=11.user-set.gif alt=user-set></p><p><code>Profiles</code> 选择桌面类型，当然如果是有其他需要，也可以不直接通过 <code>archinstall</code> 安装桌面环境。桌面环境挺多的，具体可以在 <a href=https://wiki.archlinuxcn.org/wiki/Category:%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83 target=_blank rel="noopener noreferrer">分类:桌面环境</a> 查看，此处选择 Kde Plasma。</p><p><img loading=lazy src=12.profile-set.gif alt=profile-set></p><p><code>Audio</code> 可以 <code>No audio server</code>，但还是建议随意选一个。</p><p><code>Kernels</code> 即内核，建议多选择一个 <code>linux-zen</code>，方便之后安装 <code>waydroid</code> 并运行安卓应用。</p><p><code>Network configuration</code> 建议如果选择安装了桌面环境，就使用 <code>Use NetworkManager</code>，这样可以使有无线网卡的主板，连接 WIFI。</p><p><code>Timezone</code> 选择上海。</p><p>最终的配置如下所示。</p><p><img loading=lazy src=13.end-archinstall-configuration.png alt=end-archinstall-configuration></p><p>选择 <code>Install</code>，然后回车，Archlinux 就正式开始安装了。安装过程中尽量保证网络畅通。</p><p>经过一段时间的等待，安装便完成了，会提示是否进入控制界面，选择进入。</p><p><img loading=lazy src=14.install-end.png alt=install-end></p><p>Archlinux 没有自带中文字体，所以使用 pacman 安装一下中文字体：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pacman -S noto-fonts-cjk
</span></span></code></pre></div><p>安装完成后，输入 <code>exit</code> 退出 chroot 模式，然后输入 <code>poweroff</code> 关机，将 U 盘拔掉，再开机。</p><h2 id=配置系统>配置系统</h2><p>再次启动后，会进入到 ssdm 的启动页，如下所示，说明我们已经成功安装了 Archlinux，接下来就是配置系统的时候了。</p><p><img loading=lazy src=15.enter-greeter.png alt=enter-ssdm></p><blockquote><p>如果觉得当前的启动页与 Kde 的风格不符合，可以进入 <code>系统设置->颜色和主题->登录屏幕(ssdm)</code>，选择 <code>Breeze 微风</code>并应用即可。
<img loading=lazy src=15.1.modify-ssdm-theme.png alt=modify-ssdm-theme></p></blockquote><p>输入密码进入桌面，我们依次打开 <code>左下角菜单->系统->Konsole 终端</code>。</p><blockquote><p>因为在 archinstall 中，已经修改了镜像地区，所以后续使用 pacman 或 paru 时，并不需要修改地区。如果出现安装卡住，大部分时候是因为 aur 上软件包安装文件的指定服务器，国内无法访问或者访问过慢。</p></blockquote><h3 id=安装浏览器>安装浏览器</h3><p>首先需要安装的是浏览器，火狐其实就很不错，输入下面的命令安装火狐浏览器：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pacman -S firefox
</span></span></code></pre></div><p>输入密码和 <code>y</code> 并回车继续安装。</p><p><img loading=lazy src=16.install-firefox.png alt=install-firefox></p><h3 id=安装-paru>安装 paru</h3><p>安装 <code>git</code> 和 <code>rustup</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pacman -S git rustup
</span></span></code></pre></div><p>打开浏览器，在地址栏输入 <code>http://rsproxy.cn/</code> 或者输入 <code>rsproxy</code> 并搜索，进入 rsproxy 的网站。按照教程修改 <code>.bashrc</code>，然后输入下面的命令安装 rust：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rustup install stable
</span></span></code></pre></div><p>安装完成之后，按照 rsproxy 的教程，修改 <code>~/.cargo/config</code> 或 <code>~/.cargo/config.toml</code> 的内容。</p><blockquote><p>修改文件内容时，可能会出现找不到 <code>vi</code> 指令，这是因为 Archlinux 不会默认将 <code>vim</code> 指定 <code>vi</code> 别称。</p></blockquote><p>打开 <a href=https://github.com/Morganamilo/paru target=_blank rel="noopener noreferrer">paru 的 github 仓库</a>，找到 <code>Install</code> 出，复制下面的命名开始安装 paru。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pacman -S --needed base-devel
</span></span><span class=line><span class=cl>git clone https://aur.archlinux.org/paru.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> paru
</span></span><span class=line><span class=cl>makepkg -si
</span></span></code></pre></div><h3 id=安装输入法>安装输入法</h3><p>输入法选择安装 fcitx5，即小企鹅 5。输入下面的命令安装输入法所需的所有软件包：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>paru -S fcitx5-im fcitx5-chinese-addons
</span></span></code></pre></div><blockquote><p>除了 <code>fcitx5-chinese-addons</code>，也可以查看 <a href=https://wiki.archlinuxcn.org/wiki/Fcitx5 target=_blank rel="noopener noreferrer">fcitx5 的 archlinux 页面</a>，安装其他中文输入法组件。
同时可以寻找想要安装的词库、皮肤或其他组件，也可以去搜索引擎中搜索。</p></blockquote><p>安装全部内容完成之后，进入系统设置。打开<code>键盘->虚拟键盘</code>，选择 <code>Fcitx5</code> 并应用。应用之后会提示是否启用云拼音，可以根据自己需要选择。</p><p><img loading=lazy src=17.select-virsual-keyboard-fcitx5.png alt=select-virsual-keyboard-fcitx5></p><p>现在在可以输入的地方按下 <code>Ctrl</code> + <code>Space</code>，就可以看到光标旁的 <code>en</code> 变成了 <code>拼</code>，就可以输入中文了，同时也可以再次按下 <code>Ctrl</code> + <code>Space</code> 切换回英文输入。</p><h4 id=配置输入法可选>配置输入法（可选）</h4><p>返回系统设置，找到区域和语言，选择输入法。点击配置全局选项，将 <code>切换启用/禁用输入法</code> 的快捷键修改为自己习惯的按键，此处我修改成了 <code>Shift</code> 键。</p><p><img loading=lazy src=17.1.config-fcitx5.png alt=config-fcitx5></p><p>修改好后，应用并返回，找到 <code>配置附加组件...->经典用户界面</code>，往下翻找到 <code>主题</code>，在这里可以修改输入法的主题。</p><p><img loading=lazy src=17.2.config-fcitx5-theme.png alt=config-fcitx5-theme></p><h3 id=安装-qq安装示例>安装 QQ（安装示例）</h3><p>QQ 的安装比较典型，因为 QQ 在安装之后无法正常使用输入法。</p><p>安装 QQ 可以使用下面的命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>paru -S linuxqq
</span></span></code></pre></div><p>执行时会提示有几个不同的软件包：</p><p><img loading=lazy src=18.execute-paru-s-linuxqq.png alt=execute-paru-s-linuxqq></p><p>不确定的话，可以上 <a href=https://aur.archlinux.org/ target=_blank rel="noopener noreferrer">Aur</a> 上搜索 <code>linuxqq</code>，看看几个软件包有什么区别：</p><p><img loading=lazy src=19.search-linuxqq.png alt=search-linuxqq></p><p>QQ 在之前发布过 NT 版，支持多平台。而在 <a href=https://aur.archlinux.org/ target=_blank rel="noopener noreferrer">Aur</a> 上，<code>linuxqq</code> 被标记过期，那么其实最好是选择其他的软件包安装。其中 <code>linuxqq-nt-bwrap</code> 和 <code>linuxqq-appimage</code> 任选其中一个安装即可。此处选择 2，即 <code>linuxqq-appimage</code>。</p><p>安装完成，打开并登录 QQ，此时如果想发消息，会发现切换不了输入法。</p><p>退出 QQ，打开左下角菜单，找到 QQ，<code>右键->编辑应用程序...->应用程序(A)</code>，看到参数一栏，在后面添加下面的参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>--enable-features<span class=o>=</span>UseOzonePlatform --ozone-platform<span class=o>=</span>wayland --enable-wayland-ime
</span></span></code></pre></div><p>然后就可以正常使用输入法了。</p><h2 id=结束>结束</h2><p>剩下的都可以自己慢慢摸索了。</p><p>想要的软件包可以在 <a href=https://www.archlinux.org/packages/ target=_blank rel="noopener noreferrer">Packages - Archlinux</a> 和 <a href=https://aur.archlinux.org/ target=_blank rel="noopener noreferrer">Aur</a> 上安装，Kde 社区的软件可以上 <a href=https://apps.kde.org/zh-cn/ target=_blank rel="noopener noreferrer">Kde 应用软件官网</a> 上查找。</p><p>也可以看看 <a href=https://arch.icekylin.online/guide/ target=_blank rel="noopener noreferrer">Archlinux 简明指南</a> 和 <a href=https://wiki.archlinux.org/ target=_blank rel="noopener noreferrer">Archlinux wiki</a>（<a href=https://wiki.archlinuxcn.org/wiki/%E9%A6%96%E9%A1%B5 target=_blank rel="noopener noreferrer">Archlinux 中文维基</a>）。</p></article><section class="article labels"><a class=category href=/categories/linux/>Linux</a><a class=tag href=/tags/archlinux/>archlinux</a><a class=tag href=/tags/linux/>linux</a><a class=tag href=/tags/%E5%AE%89%E8%A3%85/>安装</a></section><section class="article author"><p class=name>学少何</p><div class=bio><em>不求上进的社畜……</em></div><div class=details><a class=item href=https://github.com/studylessshape target=_blank rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;studylessshape</a></div></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/post/rust/how-to-init-llvm-sys/><span class="iconfont icon-article"></span>如何初始化 llvm-sys</a></p><p><a class=link href=/post/note/wpf-use-record/><span class="iconfont icon-article"></span>WPF 使用记录目录</a></p></section></div></section><section id=footer><div style=display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;align-content:center;align-items:center><p style=flex-shrink:0>© 2024 学少何</p><p><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://github.com/cntrump/hugo-notepadium target=_blank>Notepadium</a></p></div></section><script src=/js/hljs.min.68c549b01f2c96722917d73ba8d112d8d9bb5f891629166b777f3ff2810da2a2c9bde56eea10013cc86b58b4da4fe858.js integrity=sha384-aMVJsB8slnIpF9c7qNES2Nm7X4kWKRZrd38/8oENoqLJveVu6hABPMhrWLTaT+hY></script><script>hljs.initHighlightingOnLoad()</script></body></html>